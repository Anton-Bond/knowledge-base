
.NET Standard — это официальная спецификация для API .NET, которые должны быть доступны во всех реализациях .NET. .NET Standard была создана для того, чтобы повысить согласованность в экосистеме .NET. В .NET 5 и более поздних версиях применяется другой подход к созданию единообразия, что устраняет необходимость в .NET Standard в большинстве сценариев. Однако если вы хотите совместно использовать код между платформа .NET Framework и любой другой реализацией .NET, например .NET Core, ваша библиотека должна использовать .NET Standard 2.0. Новые версии .NET Standard не будут выпущены , но .NET 5 и все более поздние версии будут продолжать поддерживать .NET Standard 2.1 и более ранних версий.

### Какую версию .NET Standard выбрать в качестве целевой

Если вы используете .NET Standard, рекомендуется использовать .NET Standard 2.0, если вам не нужно поддерживать более раннюю версию. Большинство библиотек общего назначения не должны нуждаться в API вне .NET Standard 2.0, и платформа .NET Framework не поддерживает .NET Standard 2.1. Платформу .NET Standard 2.0 поддерживают все современные платформы. Ее рекомендуется использовать всегда, когда нужно реализовать кроссплатформенность с помощью одной целевой платформы.

Если вам требуется поддержка .NET Standard 1.x, мы рекомендуем также выбрать .NET Standard 2.0. .NET Standard 1.x распространяется в виде детализированного набора пакетов NuGet, который создает большой пакет граф зависимостей и приводит к загрузке большого количества пакетов при создании проекта.

### Правила управления версиями .NET Standard

Существует два основных правила управления версиями.
 - Аддитивность. Все версии .NET Standard логически расширяются, то есть более поздние версии содержат все интерфейсы API предыдущих версий. Отсутствуют критические изменения между версиями. 
 - Неизменяемость: версии .NET после выпуска закрепляются в определенном состоянии.

После .NET Standard 2.1 выпуск новых версий не планируется

### Режим совместимости .NET Framework

Начиная с .NET Standard 2.0, доступен режим совместимости .NET Framework. Этот режим совместимости позволяет проектам .NET Standard ссылаться на библиотеки .NET Framework, как если бы они были скомпилированы для .NET Standard. Создание ссылок на библиотеки .NET Framework не работает для всех проектов, например таких, где библиотека использует API Windows Presentation Foundation (WPF).

### .NET 5+ и .NET Standard

.NET 5, .NET 6, .NET 7, .NET 8 и .NET 9 — это единый набор возможностей и API, которые можно использовать для классических приложений Windows и кроссплатформенных консольных приложений, облачных служб и веб-сайтов.

### Проблемы, связанные с .NET Standard

В этом разделе описываются некоторые проблемы, связанные с использованием .NET Standard. Вы узнаете, почему .NET 5 является предпочтительной платформой для совместного использования кода разными платформами и рабочими нагрузками:

 - Задержки с добавлением новых API
 
 Платформа .NET Standard была создана как набор API, который должен поддерживать все реализации .NET, поэтому был определен процесс проверки предложений по добавлению новых API. Цель заключалась в том, чтобы стандартизировать только те API, которые могут быть реализованы на всех текущих и будущих платформах .NET. В результате, если был пропущен определенный выпуск функции, на ее добавление в версию Standard может уйти несколько лет. При этом ожидание того, что новая версия .NET Standard получит всеобщую поддержку, может длиться еще дольше. 
 
 Решение в .NET 5+. Когда функция реализована, она уже доступна для каждого приложения и библиотеки .NET 5+, так как база кода является общей. А поскольку различия между спецификацией API и его реализацией отсутствуют, вы можете воспользоваться преимуществами новых функций гораздо быстрее, чем в случае с .NET Standard.

 - Сложная система управления версиями

Разделение спецификации API и его реализации приводит к сложному сопоставлению между версиями спецификаций API и их реализаций. Эта видно из приведенной ранее в этой статье таблицы и инструкций по ее интерпретации. Проблемы, связанные с .NET Standard

Решение в .NET 5+. Разделения между спецификацией API .NET 5+ и ее реализацией нет. Это позволяет получить упрощенную схему моникеров целевой платформы. Для всех рабочих нагрузок (библиотеки, консольные приложения и веб-приложения) используется один префикс моникера целевой платформы: net9.0 . Изменения касаются только суффикса, который определяет API, предназначенные для конкретной платформы, например net9.0-windows . Благодаря этому соглашению об именовании TFM можно легко определить, способно ли данное приложение использовать указанную библиотеку. При этом таблицы эквивалентности номеров версий, как в случае с .NET Standard, не требуются.

 - Не поддерживаемые платформой исключения во время выполнения

.NET Standard предоставляет интерфейсы API для конкретных платформ. При этом ваш код может компилироваться без ошибок и выглядеть доступным для переноса на любую платформу, в то время как на самом деле это не так. При запуске на платформе, на которой отсутствует реализация для данного API, во время выполнения будут возникать ошибки.

Решение в .NET 5+. Пакеты SDK для .NET 5+ включают анализаторы кода, которые включены по умолчанию. Анализатор совместимости платформ обнаруживает непреднамеренное использование API, которые не поддерживаются на платформах, на которых предполагается работать.