Асинхронное программирование основано на **[[Машина состояний]] (state machine)**, которая автоматически генерируется компилятором.

### **Как это работает:**

1. Асинхронный метод компилируется в класс с конечным автоматом.
2. Когда вызывается метод с `await`, он разбивается на несколько состояний:
    - До выполнения `await`.
    - Во время ожидания задачи.
    - После выполнения задачи.
3. Во время `await` метод выходит, передавая управление вызывающему коду.
4. После завершения задачи выполнение метода возобновляется.

**Пример:**
```C#
public async Task ExampleAsync()
{
    Console.WriteLine("Start");
    await Task.Delay(1000); // Переключение состояния
    Console.WriteLine("End");
}
```

После компиляции этот метод превращается в код с конечным автоматом, который управляет состояниями.