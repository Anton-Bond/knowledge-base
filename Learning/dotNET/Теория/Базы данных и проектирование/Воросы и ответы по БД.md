## **1. Общие вопросы по SQL**

**1.1. Что такое SQL и какие задачи он решает?**  
➡ SQL – это язык управления данными в реляционных базах. Позволяет выполнять CRUD-операции (Create, Read, Update, Delete), управлять схемой данных и настройками безопасности.

**1.2. Какие виды SQL-запросов существуют?**  
➡ DML (INSERT, UPDATE, DELETE, SELECT), DDL (CREATE, ALTER, DROP), DCL (GRANT, REVOKE), TCL (COMMIT, ROLLBACK, SAVEPOINT).

**1.3. Чем отличается DELETE от TRUNCATE?**  
➡ `DELETE` удаляет строки с возможностью `ROLLBACK`, `TRUNCATE` очищает таблицу без логирования.

**1.4. Чем отличается SQL от NoSQL?**  
➡ SQL – строгая структура (таблицы, связи). NoSQL – гибкая структура (документы, графы, key-value).

---

## **2. JOIN и их виды**

**2.1. Что такое JOIN?**  
➡ `JOIN` – это оператор SQL для объединения данных из нескольких таблиц.

**2.2. Чем отличается INNER JOIN от LEFT JOIN?**  
➡ `INNER JOIN` возвращает только совпадающие записи, `LEFT JOIN` возвращает все из левой таблицы + совпадения.

**2.3. Почему OUTER JOIN медленный?**  
➡ Потому что он объединяет **все строки обеих таблиц**, что приводит к большому количеству вычислений.

**2.4. В чем опасность многократных LEFT JOIN?**  
➡ Возможны **дублирования данных** и **падение производительности**. Нужно проверять `NULL` и индексировать FK.

---

## **3. Индексы**

**3.1. Какие бывают индексы?**  
➡ Кластерные (`CLUSTERED`) – сортируют данные, один на таблицу. Некластерные (`NONCLUSTERED`) – создают доп. структуры для быстрого поиска.

**3.2. Какие минусы индексов?**  
➡ Замедляют вставку (`INSERT`), увеличивают размер БД, требуют обслуживания (`REBUILD`, `REORGANIZE`).

**3.3. В каких случаях индекс не используется?**  
➡ При `LIKE '%value%'`, при `OR` в `WHERE`, если в запросе нет условий по индексированному столбцу.

---

## **4. Хранимые процедуры и триггеры**

**4.1. Что такое хранимая процедура?**  
➡ SQL-скрипт, который выполняется в БД.

**4.2. Какие преимущества хранимых процедур?**  
➡ Ускоряют выполнение, уменьшают трафик между сервером и клиентом, повышают безопасность.

**4.3. Какие минусы хранимых процедур?**  
➡ Сложная поддержка, ухудшение масштабируемости, трудно отлаживать.

**4.4. Что такое триггер?**  
➡ Автоматический обработчик событий (INSERT, UPDATE, DELETE).

**4.5. Какие проблемы могут возникнуть с триггерами?**  
➡ Скрытые операции, циклы (`AFTER INSERT` → `INSERT`), замедление работы.

---

## **5. ORM в .NET**

**5.1. Что такое ORM?**  
➡ Object-Relational Mapping – работа с БД через объекты.

**5.2. Какие ORM используются в .NET?**  
➡ Entity Framework Core, Dapper, ADO.NET.

**5.3. В чем плюсы и минусы EF Core?**  
✔ Простота (`Migrations`, `LINQ`)  
❌ Сложность для оптимизации (`N+1`, кеширование, производительность).

**5.4. Когда лучше использовать Dapper?**  
➡ Когда важна **производительность** и нужен **гибкий SQL-контроль**.

**5.5. Чем ADO.NET отличается от ORM?**  
➡ ADO.NET – **низкоуровневый API** для работы с БД через `SqlCommand`, `SqlDataReader`.

---

## **6. Транзакции и ACID**

**6.1. Что такое транзакция?**  
➡ Группировка SQL-операций в один атомарный блок.

**6.2. Что такое ACID?**  
➡ **Атомарность**, **Согласованность**, **Изоляция**, **Долговечность** – гарантии целостности данных.

**6.3. Какие уровни изоляции бывают?**  
✔ Read Uncommitted – грязные чтения, но быстрая.  
✔ Read Committed – только подтвержденные данные.  
✔ Repeatable Read – запрет изменения прочитанного.  
✔ Serializable – строгий контроль, но медленный.

**6.4. Как работать с транзакциями в .NET?**  
➡ Использовать `TransactionScope`:

```csharp
using (var scope = new TransactionScope())
{
    // SQL-запросы
    scope.Complete(); // Коммит транзакции
}
```

**6.5. Что такое deadlock?**  
➡ Взаимная блокировка ресурсов двумя процессами.

**6.6. Как избежать deadlock?**  
✔ Всегда блокировать ресурсы в **одинаковом порядке**.  
✔ Использовать **NOLOCK** (`WITH (NOLOCK)`).  
✔ Выставлять **таймаут транзакции**.

---

## **7. Проектирование БД**

**7.1. Какие ключевые принципы проектирования БД?**  
✔ Нормализация данных.  
✔ Использование индексов.  
✔ Оптимизированные связи (FK).

**7.2. Что такое нормализация?**  
➡ Процесс **устранения дублирования данных**.

**7.3. Какие формы нормализации существуют?**  
✔ **1NF** – Исключение повторяющихся колонок.  
✔ **2NF** – Все атрибуты зависят от PK.  
✔ **3NF** – Исключение транзитивных зависимостей.

**7.4. Что такое денормализация?**  
➡ Добавление избыточных данных для ускорения запросов.

**7.5. Какие ошибки при проектировании БД встречаются чаще всего?**  
❌ Отсутствие индексов.  
❌ Чрезмерная нормализация.  
❌ Избыточное количество связей.

---

## **8. .NET и базы данных**

**8.1. Как работает EF Core?**  
➡ Использует `DbContext`, `DbSet`, `LINQ to SQL`.

**8.2. Как избежать N+1 проблемы в EF Core?**  
✔ Использовать `Include()`.  
✔ Загружать данные через `Projection`.

**8.3. Что такое Lazy Loading?**  
➡ Данные загружаются при первом обращении.

**8.4. Как использовать миграции в EF Core?**

```sh
dotnet ef migrations add InitialCreate
dotnet ef database update
```

**8.5. Какой метод загрузки данных быстрее: Dapper или EF Core?**  
➡ `Dapper` быстрее, но требует ручного написания SQL.
